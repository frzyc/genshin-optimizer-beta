"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[234],{29117:(e,n,t)=>{t.d(n,{Z:()=>Z});var a=t(31461),o=t(92794),l=t(66198),s=t(79536),i=t(36893),r=t(10618),c=t(26578),u=t(29432),d=t(52903);const p=["value","totals","onChange"],h=(0,r.X)([...i.yd]);function Z(e){let{value:n,totals:t,onChange:r}=e,Z=(0,a.Z)(e,p);return(0,d.tZ)(u.Z,Object.assign({exclusive:!0,value:n},Z,{children:i.yd.map((e=>{var a;return(0,d.BX)(o.Z,{value:e,sx:{minWidth:"7em"},onClick:()=>r(h(n,e)),children:[(0,d.tZ)(c.Z,{src:null==(a=s.Z.weaponTypes)?void 0:a[e],size:2})," ",(0,d.tZ)(l.Z,{label:t[e],size:"small"})]},e)}))}))}},61523:(e,n,t)=>{t.r(n),t.d(n,{default:()=>N});var a=t(92252),o=t(67550),l=t(7671),s=t(41075),i=t(30609),r=t(5896),c=t(79906),u=t(83249),d=t(62197),p=t(2784),h=t(61877),Z=t(21548),g=t(87985),w=t(46026),m=t(62978),f=t(29117),y=t(51077),v=t(25870),x=t(36617),b=t(82716),W=t(36893),C=t(1661),I=t(40775),k=t(41015),P=t(77712),S=t(64120),X=t(3694),E=t(52903);const T=p.lazy((()=>t.e(592).then(t.bind(t,89431)))),B=(0,p.lazy)((()=>Promise.all([t.e(878),t.e(334)]).then(t.bind(t,15878)))),$={xs:1,sm:2,md:3,lg:3,xl:4},z={xs:10,sm:12,md:24,lg:24,xl:24},j=Object.keys(P.gd);function N(){const{t:e}=(0,Z.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,p.useContext)(v.t),[t,d]=(0,p.useState)(n.displayWeapon.get());(0,p.useEffect)((()=>n.displayWeapon.follow(((e,n)=>d(n)))),[n]);const[N,O]=(0,p.useState)(!1),[D,_]=(0,x.Z)(),G=(0,p.useRef)(null),[A,H]=(0,p.useState)(0);(0,p.useEffect)((()=>(h.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&_())))),[_,n]);const K=(0,b.Z)(),L=z[K],V=(0,p.useCallback)((async a=>{const o=n.weapons.get(a);if(!o)return;const l=e(`weaponNames_gen:${o.key}`);window.confirm(e("removeWeapon",{value:l}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),q=(0,p.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),F=(0,p.useCallback)((e=>{q(n.weapons.new((0,S.xg)(e)))}),[n,q]),[R,J]=(0,p.useState)(""),Q=(0,p.useDeferredValue)(R),{sortType:U,ascending:Y,weaponType:ee,rarity:ne}=t,{weaponIdList:te,totalWeaponNum:ae}=(0,p.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length,o=t.filter((0,C.C)({weaponType:ee,rarity:ne,name:Q},(0,P.Xg)())).sort((0,C.e)(null!=(e=P.gd[U])?e:[],Y,(0,P.Sn)())).map((e=>e.id));return D&&{weaponIdList:o,totalWeaponNum:a}}),[D,n,U,Y,ne,ee,Q]),{weaponIdsToShow:oe,numPages:le,currentPageIndex:se}=(0,p.useMemo)((()=>{const e=Math.ceil(te.length/L),n=(0,k.uZ)(A,0,e-1);return{weaponIdsToShow:te.slice(n*L,(n+1)*L),numPages:e,currentPageIndex:n}}),[te,A,L]),ie=te.length!==ae?`${te.length}/${ae}`:`${ae}`,re=(0,p.useCallback)(((e,n)=>{var t;null==(t=G.current)||t.scrollIntoView({behavior:"smooth"}),H(n-1)}),[H,G]),ce=(0,p.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:ue}=t;(0,p.useEffect)((()=>{ue&&(n.weapons.get(ue)||ce())}),[n,ue,ce]);const de=(0,p.useMemo)((()=>(0,I.W)(W.yd,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,y.ub)(t.key).weaponType;e[a].total++,te.includes(n)&&e[a].current++}))))),[n,te]),pe=(0,p.useMemo)((()=>(0,I.W)(W.wC,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,y.ub)(t.key).rarity;e[a].total++,te.includes(n)&&e[a].current++}))))),[n,te]);return(0,E.BX)(o.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,E.tZ)(p.Suspense,{fallback:!1,children:(0,E.tZ)(T,{show:N,onHide:()=>O(!1),onSelect:F})}),(0,E.tZ)(p.Suspense,{fallback:!1,children:(0,E.tZ)(B,{weaponId:ue,footer:!0,onClose:ce})}),(0,E.tZ)(g.Z,{ref:G,children:(0,E.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,E.BX)(s.ZP,{container:!0,spacing:1,children:[(0,E.tZ)(s.ZP,{item:!0,children:(0,E.tZ)(f.Z,{onChange:e=>n.displayWeapon.set({weaponType:e}),value:ee,totals:de,size:"small"})}),(0,E.tZ)(s.ZP,{item:!0,children:(0,E.tZ)(m.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({rarity:e}),value:ne,totals:pe,size:"small"})}),(0,E.tZ)(s.ZP,{item:!0,flexGrow:1}),(0,E.tZ)(s.ZP,{item:!0,children:(0,E.tZ)(i.Z,{autoFocus:!0,size:"small",value:R,onChange:e=>J(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,E.BX)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:[(0,E.tZ)(r.Z,{count:le,page:se+1,onChange:re}),(0,E.tZ)(M,{numShowing:oe.length,total:ie,t:e}),(0,E.tZ)(w.Z,{sx:{height:"100%"},sortKeys:j,value:U,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:Y,onChangeAsc:e=>n.displayWeapon.set({ascending:e})})]})]})}),(0,E.BX)(p.Suspense,{fallback:(0,E.tZ)(c.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,E.tZ)(u.Z,{fullWidth:!0,onClick:()=>O(!0),color:"info",startIcon:(0,E.tZ)(a.Z,{}),children:e("page_weapon:addWeapon")}),(0,E.tZ)(s.ZP,{container:!0,spacing:1,columns:$,children:oe.map((e=>(0,E.tZ)(s.ZP,{item:!0,xs:1,children:(0,E.tZ)(X.Z,{weaponId:e,onDelete:V,onEdit:q,canEquip:!0})},e)))})]}),le>1&&(0,E.tZ)(g.Z,{children:(0,E.tZ)(l.Z,{children:(0,E.BX)(s.ZP,{container:!0,alignItems:"flex-end",children:[(0,E.tZ)(s.ZP,{item:!0,flexGrow:1,children:(0,E.tZ)(r.Z,{count:le,page:se+1,onChange:re})}),(0,E.tZ)(s.ZP,{item:!0,children:(0,E.tZ)(M,{numShowing:oe.length,total:ie,t:e})})]})})})]})}function M({numShowing:e,total:n,t}){return(0,E.tZ)(d.Z,{color:"text.secondary",children:(0,E.BX)(Z.cC,{t,i18nKey:"showingNum",count:e,value:n,children:["Showing ",(0,E.tZ)("b",{children:{count:e}})," out of ",{value:n}," Weapons"]})})}},94758:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(2784),o=t(25870);function l(e=""){const{database:n}=(0,a.useContext)(o.t),[t,l]=(0,a.useState)(n.weapons.get(e));return(0,a.useEffect)((()=>l(n.weapons.get(e))),[n,e]),(0,a.useEffect)((()=>e?n.weapons.follow(e,((e,n,t)=>"update"===n&&l(t))):void 0),[e,l,n]),t}},10618:(e,n,t)=>{t.d(n,{X:()=>o});var a=t(41015);function o(e){return(n,t)=>{const o=n.length;return o===e.length?[t]:1===o&&n[0]===t?[...e]:[...new Set((0,a.nh)(n,t))]}}},40775:(e,n,t)=>{t.d(n,{W:()=>o});var a=t(41015);function o(e,n){const t=function(e){return Object.fromEntries(e.map((e=>[e,{total:0,current:0}])))}(e);return n(t),o=t,(0,a.xh)(o,(({total:e,current:n})=>n===e?`${e}`:`${n}/${e}`));var o}}}]);