"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[902],{61523:(e,n,t)=>{t.r(n),t.d(n,{default:()=>M});var a=t(92252),o=t(67550),s=t(7671),l=t(41075),i=t(30609),r=t(5896),c=t(79906),u=t(83249),p=t(62197),d=t(2784),h=t(61877),Z=t(21548),g=t(87985),w=t(46026),f=t(62978),m=t(29117),y=t(71026),x=t(25870),W=t(36617),v=t(82716),b=t(25434),C=t(36893),I=t(1661),k=t(40775),P=t(41015),S=t(77712),E=t(64120),T=t(3694),X=t(52903);const $=d.lazy((()=>t.e(592).then(t.bind(t,89431)))),B=(0,d.lazy)((()=>Promise.all([t.e(592),t.e(334)]).then(t.bind(t,15878)))),N={xs:1,sm:2,md:3,lg:3,xl:4},j={xs:10,sm:12,md:24,lg:24,xl:24},z=Object.keys(S.gd);function M(){const{t:e}=(0,Z.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,d.useContext)(x.t),[t,p]=(0,d.useState)(n.displayWeapon.get());(0,d.useEffect)((()=>n.displayWeapon.follow(((e,n)=>p(n)))),[n]);const[M,O]=(0,d.useState)(!1),[_,A]=(0,W.Z)(),G=(0,d.useRef)(null),[L,H]=(0,d.useState)(0);(0,d.useEffect)((()=>(h.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&A())))),[A,n]);const K=(0,v.Z)(),V=j[K],q=(0,b.Z)((()=>y.Z.getAll),[]),F=(0,d.useCallback)((async a=>{const o=n.weapons.get(a);if(!o)return;const s=e(`weaponNames_gen:${o.key}`);window.confirm(e("removeWeapon",{value:s}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),R=(0,d.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),J=(0,d.useCallback)((e=>{R(n.weapons.new((0,E.xg)(e)))}),[n,R]),[Q,U]=(0,d.useState)(""),Y=(0,d.useDeferredValue)(Q),{sortType:ee,ascending:ne,weaponType:te,rarity:ae}=t,{weaponIdList:oe,totalWeaponNum:se}=(0,d.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length;if(!q)return{weaponIdList:[],totalWeaponNum:a};const o=t.filter((0,I.C)({weaponType:te,rarity:ae,name:Y},(0,S.Xg)(q))).sort((0,I.e)(null!=(e=S.gd[ee])?e:[],ne,(0,S.Sn)(q))).map((e=>e.id));return _&&{weaponIdList:o,totalWeaponNum:a}}),[_,n,q,ee,ne,ae,te,Y]),{weaponIdsToShow:le,numPages:ie,currentPageIndex:re}=(0,d.useMemo)((()=>{const e=Math.ceil(oe.length/V),n=(0,P.uZ)(L,0,e-1);return{weaponIdsToShow:oe.slice(n*V,(n+1)*V),numPages:e,currentPageIndex:n}}),[oe,L,V]),ce=oe.length!==se?`${oe.length}/${se}`:`${se}`,ue=(0,d.useCallback)(((e,n)=>{var t;null==(t=G.current)||t.scrollIntoView({behavior:"smooth"}),H(n-1)}),[H,G]),pe=(0,d.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:de}=t;(0,d.useEffect)((()=>{de&&(n.weapons.get(de)||pe())}),[n,de,pe]);const he=(0,d.useMemo)((()=>(0,k.W)(C.yd,(e=>q&&Object.entries(n.weapons.data).forEach((([n,t])=>{const a=q(t.key).weaponType;e[a].total++,oe.includes(n)&&e[a].current++}))))),[q,n,oe]),Ze=(0,d.useMemo)((()=>(0,k.W)(C.wC,(e=>q&&Object.entries(n.weapons.data).forEach((([n,t])=>{const a=q(t.key).rarity;e[a].total++,oe.includes(n)&&e[a].current++}))))),[q,n,oe]);return(0,X.BX)(o.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,X.tZ)(d.Suspense,{fallback:!1,children:(0,X.tZ)($,{show:M,onHide:()=>O(!1),onSelect:J})}),(0,X.tZ)(d.Suspense,{fallback:!1,children:(0,X.tZ)(B,{weaponId:de,footer:!0,onClose:pe})}),(0,X.tZ)(g.Z,{ref:G,children:(0,X.BX)(s.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,X.BX)(l.ZP,{container:!0,spacing:1,children:[(0,X.tZ)(l.ZP,{item:!0,children:(0,X.tZ)(m.Z,{onChange:e=>n.displayWeapon.set({weaponType:e}),value:te,totals:he,size:"small"})}),(0,X.tZ)(l.ZP,{item:!0,children:(0,X.tZ)(f.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({rarity:e}),value:ae,totals:Ze,size:"small"})}),(0,X.tZ)(l.ZP,{item:!0,flexGrow:1}),(0,X.tZ)(l.ZP,{item:!0,children:(0,X.tZ)(i.Z,{autoFocus:!0,size:"small",value:Q,onChange:e=>U(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,X.BX)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:[(0,X.tZ)(r.Z,{count:ie,page:re+1,onChange:ue}),(0,X.tZ)(D,{numShowing:le.length,total:ce,t:e}),(0,X.tZ)(w.Z,{sx:{height:"100%"},sortKeys:z,value:ee,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:ne,onChangeAsc:e=>n.displayWeapon.set({ascending:e})})]})]})}),(0,X.BX)(d.Suspense,{fallback:(0,X.tZ)(c.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,X.tZ)(u.Z,{fullWidth:!0,onClick:()=>O(!0),color:"info",startIcon:(0,X.tZ)(a.Z,{}),children:e("page_weapon:addWeapon")}),(0,X.tZ)(l.ZP,{container:!0,spacing:1,columns:N,children:le.map((e=>(0,X.tZ)(l.ZP,{item:!0,xs:1,children:(0,X.tZ)(T.Z,{weaponId:e,onDelete:F,onEdit:R,canEquip:!0})},e)))})]}),ie>1&&(0,X.tZ)(g.Z,{children:(0,X.tZ)(s.Z,{children:(0,X.BX)(l.ZP,{container:!0,alignItems:"flex-end",children:[(0,X.tZ)(l.ZP,{item:!0,flexGrow:1,children:(0,X.tZ)(r.Z,{count:ie,page:re+1,onChange:ue})}),(0,X.tZ)(l.ZP,{item:!0,children:(0,X.tZ)(D,{numShowing:le.length,total:ce,t:e})})]})})})]})}function D({numShowing:e,total:n,t}){return(0,X.tZ)(p.Z,{color:"text.secondary",children:(0,X.BX)(Z.cC,{t,i18nKey:"showingNum",count:e,value:n,children:["Showing ",(0,X.tZ)("b",{children:{count:e}})," out of ",{value:n}," Weapons"]})})}},94758:(e,n,t)=>{t.d(n,{Z:()=>s});var a=t(2784),o=t(25870);function s(e=""){const{database:n}=(0,a.useContext)(o.t),[t,s]=(0,a.useState)(n.weapons.get(e));return(0,a.useEffect)((()=>s(n.weapons.get(e))),[n,e]),(0,a.useEffect)((()=>e?n.weapons.follow(e,((e,n,t)=>"update"===n&&s(t))):void 0),[e,s,n]),t}},10618:(e,n,t)=>{t.d(n,{X:()=>o});var a=t(41015);function o(e){return(n,t)=>{const o=n.length;return o===e.length?[t]:1===o&&n[0]===t?[...e]:[...new Set((0,a.nh)(n,t))]}}},40775:(e,n,t)=>{t.d(n,{W:()=>o});var a=t(41015);function o(e,n){const t=function(e){return Object.fromEntries(e.map((e=>[e,{total:0,current:0}])))}(e);return n(t),o=t,(0,a.xh)(o,(({total:e,current:n})=>n===e?`${e}`:`${n}/${e}`));var o}}}]);