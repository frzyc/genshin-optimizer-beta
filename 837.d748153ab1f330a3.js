"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[837],{28504:(t,e,n)=>{var a=n(71600);e.Z=void 0;var r=a(n(68671)),l=n(52322),o=(0,r.default)((0,l.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");e.Z=o},22905:(t,e,n)=>{var a=n(71600);e.Z=void 0;var r=a(n(68671)),l=n(52322),o=(0,r.default)((0,l.jsx)("path",{d:"m20.41 8.41-4.83-4.83c-.37-.37-.88-.58-1.41-.58H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9.83c0-.53-.21-1.04-.59-1.42zM7 7h7v2H7V7zm10 10H7v-2h10v2zm0-4H7v-2h10v2z"}),"TextSnippet");e.Z=o},63236:(t,e,n)=>{var a=n(71600);e.Z=void 0;var r=a(n(68671)),l=n(52322),o=(0,r.default)((0,l.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile");e.Z=o},5658:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(6620),r=n(52322);const l=(0,a.Z)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},27216:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(6620),r=n(52322);const l=(0,a.Z)((0,r.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},35837:(t,e,n)=>{n.r(e),n.d(e,{default:()=>pt});var a=n(7671),r=n(62197),l=n(56961),o=n(61877),i=n(21548),c=n(87985),s=n(6620),d=n(52322);const Z=(0,s.Z)((0,d.jsx)("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),h=(0,s.Z)((0,d.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var u=n(68164);const p=(0,s.Z)((0,d.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");var g=n(1811),m=n(41075),x=n(83249),C=n(66198),b=n(67550),v=n(2784),f=n(67937),y=n(89343),B=n(98927),w=n(25870),X=n(94657),D=n(41015);const k=(0,s.Z)((0,d.jsx)("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H15v-8h5V8l-6-6zm-1 7V3.5L18.5 9H13zm4 12.66V16h5.66v2h-2.24l2.95 2.95-1.41 1.41L19 19.41v2.24h-2z"}),"FileOpen");var I=n(27216),z=n(5658),G=n(28504),H=n(22905),K=n(63236),P=n(65992),j=n(23883),S=n(76068),$=n(29063),L=n(52903);let M,O,V,E,T,W,F,R=t=>t;const N=(0,P.ZP)("input")({display:"none"});function A({index:t,onReplace:e}){var n;const{databases:l}=(0,v.useContext)(w.t),o=l[t],{t:s}=(0,i.$G)("settings"),[d,Z]=(0,v.useState)(""),[h,u]=(0,v.useState)(""),[p,g]=(0,v.useState)(""),[C,y]=(0,v.useState)(!1),[B,X]=(0,v.useState)(!1),{importResult:D,importedDatabase:K}=null!=(n=(0,v.useMemo)((()=>{if(!d)return;let e;try{if(e=JSON.parse(d),"object"!=typeof e)return void g("uploadCard.error.jsonParse")}catch(n){return void g("uploadCard.error.jsonParse")}if("GOOD"===e.format){const n=new S.N;n.copyFrom(o.storage);const a=new w.M(t+1,n),r=a.importGOOD(e,C,B);return r?{importResult:r,importedDatabase:a}:void g("uploadCard.error.goInvalid")}g("uploadCard.error.unknown")}),[d,o,C,B,t]))?n:{};return(0,L.BX)(f.Z,{children:[(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.tZ)(i.cC,{t:s,i18nKey:"settings:uploadCard.title"})}),(0,L.BX)(a.Z,{children:[(0,L.BX)(m.ZP,{container:!0,spacing:2,sx:{mb:1},children:[(0,L.tZ)(m.ZP,{item:!0,children:(0,L.BX)("label",{htmlFor:"icon-button-file",children:[(0,L.tZ)(N,{accept:".json",id:"icon-button-file",type:"file",onChange:async t=>{const e=t.target.files[0];t.target.value=null,e&&u(e.name);const n=new FileReader;n.onload=()=>Z(n.result),n.readAsText(e)}}),(0,L.tZ)(x.Z,{component:"span",color:"info",startIcon:(0,L.tZ)(k,{}),children:s(M||(M=R`uploadCard.buttons.open`))})]})}),(0,L.tZ)(m.ZP,{item:!0,flexGrow:1,children:(0,L.tZ)(c.Z,{sx:{px:2,py:1},children:(0,L.tZ)(r.Z,{children:h?(0,L.BX)("span",{children:[(0,L.tZ)(H.Z,Object.assign({},$.m))," ",h]}):(0,L.BX)("span",{children:[(0,L.tZ)(G.Z,Object.assign({},$.m))," ",(0,L.tZ)(i.cC,{t:s,i18nKey:"settings:uploadCard.hint"})]})})})})]}),(0,L.BX)(b.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,L.tZ)(j.Z,{title:(0,L.tZ)(r.Z,{children:s(B?O||(O=R`uploadCard.tooltip.ignoreDup`):V||(V=R`uploadCard.tooltip.detectdup`))}),placement:"top",arrow:!0,children:(0,L.tZ)(b.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,L.tZ)(x.Z,{fullWidth:!0,disabled:!d,color:B?"primary":"success",onClick:()=>X(!B),startIcon:B?(0,L.tZ)(I.Z,{}):(0,L.tZ)(z.Z,{}),children:s(E||(E=R`uploadCard.buttons.detectDups`))})})}),(0,L.tZ)(j.Z,{title:(0,L.tZ)(r.Z,{children:s(C?T||(T=R`uploadCard.tooltip.keepNotInImport`):W||(W=R`uploadCard.tooltip.delNotInImport`))}),placement:"top",arrow:!0,children:(0,L.tZ)(b.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,L.tZ)(x.Z,{fullWidth:!0,disabled:!d,color:C?"primary":"success",onClick:()=>y(!C),startIcon:C?(0,L.tZ)(I.Z,{}):(0,L.tZ)(z.Z,{}),children:s(F||(F=R`uploadCard.buttons.delNotInImport`))})})})]}),(0,L.tZ)(r.Z,{gutterBottom:!0,variant:"caption",children:(0,L.tZ)(i.cC,{t:s,i18nKey:"settings:uploadCard.hintPaste"})}),(0,L.tZ)(b.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",mb:2,resize:"vertical"},value:d,onChange:t=>Z(t.target.value)}),D&&K?(0,L.tZ)(J,{importResult:D,importedDatabase:K}):s(p)]}),(0,L.tZ)(U,{index:t,importedDatabase:K,reset:()=>{Z(""),u(""),e()}})]})}function J({importResult:{source:t,artifacts:e,characters:n,weapons:o},importedDatabase:s}){const{t:d}=(0,i.$G)("settings");return(0,L.BX)(c.Z,{children:[(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:d,i18nKey:"uploadCard.dbSource"}),(0,L.BX)("strong",{children:[" ",t]})]})}),(0,L.tZ)(l.Z,{}),(0,L.tZ)(a.Z,{children:(0,L.BX)(m.ZP,{container:!0,spacing:2,children:[(0,L.tZ)(m.ZP,{item:!0,flexGrow:1,children:(0,L.tZ)(_,{result:e,dbTotal:s.arts.values.length,type:"arts"})}),(0,L.tZ)(m.ZP,{item:!0,flexGrow:1,children:(0,L.tZ)(_,{result:o,dbTotal:s.weapons.values.length,type:"weapons"})}),(0,L.tZ)(m.ZP,{item:!0,flexGrow:1,children:(0,L.tZ)(_,{result:n,dbTotal:s.chars.values.length,type:"chars"})})]})})]})}function _({result:t,dbTotal:e,type:n}){var o;const{t:c}=(0,i.$G)("settings"),s=t.import;return(0,L.BX)(f.Z,{children:[(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:`count.${n}`})," ",s]})}),(0,L.tZ)(l.Z,{}),(0,L.BX)(a.Z,{children:[(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.new"})," ",(0,L.tZ)("strong",{children:t.new.length})," / ",s]}),(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.unchanged"})," ",(0,L.tZ)("strong",{children:t.unchanged.length})," / ",s]}),(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.upgraded"})," ",(0,L.tZ)("strong",{children:t.upgraded.length})," / ",s]}),!!t.remove.length&&(0,L.BX)(r.Z,{color:"warning.main",children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.removed"})," ",(0,L.tZ)("strong",{children:t.remove.length})]}),!!t.notInImport&&(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.notInImport"})," ",(0,L.tZ)("strong",{children:t.notInImport})]}),(0,L.BX)(r.Z,{children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.dbTotal"})," ",(0,L.tZ)("strong",{children:t.beforeMerge})," -> ",(0,L.tZ)("strong",{children:e})]}),!(null==(o=t.invalid)||!o.length)&&(0,L.BX)("div",{children:[(0,L.BX)(r.Z,{color:"error.main",children:[(0,L.tZ)(i.cC,{t:c,i18nKey:"count.invalid"})," ",(0,L.tZ)("strong",{children:t.invalid.length})," / ",s]}),(0,L.tZ)(b.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",resize:"vertical"},value:JSON.stringify(t.invalid,void 0,2),disabled:!0})]})]})]})}function U({index:t,importedDatabase:e,reset:n}){const{databases:r,setDatabase:o}=(0,v.useContext)(w.t),c=r[t],{t:s}=(0,i.$G)("settings"),d=(0,v.useCallback)((()=>{e&&(e.swapStorage(c),o(t,e),e.toExtraLocalDB(),n())}),[c,t,e,n,o]);return(0,L.BX)(L.HY,{children:[(0,L.tZ)(l.Z,{}),(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.tZ)(x.Z,{color:e?"success":"error",disabled:!e,onClick:d,startIcon:(0,L.tZ)(K.Z,{}),children:(0,L.tZ)(i.cC,{t:s,i18nKey:"settings:uploadCard.replaceDatabase"})})})]})}let Y,q,Q,tt,et,nt,at,rt=t=>t;function lt(){const{t}=(0,i.$G)(["settings"]);return(0,L.BX)(f.Z,{children:[(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.tZ)(r.Z,{variant:"subtitle1",children:t(Y||(Y=rt`DatabaseCard.title`))})}),(0,L.tZ)(l.Z,{}),(0,L.tZ)(a.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,L.tZ)(m.ZP,{container:!0,spacing:2,columns:{xs:1,md:2},children:(0,D.w6)(0,3).map((t=>(0,L.tZ)(m.ZP,{item:!0,xs:1,children:(0,L.tZ)(ot,{index:t})},t)))})})]})}function ot({index:t}){const{databases:e,database:n,setDatabase:o}=(0,v.useContext)(w.t),s=e[t],[{name:d,lastEdit:f},D]=(0,v.useState)(s.dbMeta.get());(0,v.useEffect)((()=>s.dbMeta.follow(((t,e)=>D(e)))),[s]),(0,v.useEffect)((()=>D(s.dbMeta.get())),[s]);const k=n===s,[I,z,G]=(0,X.Z)(),{t:H}=(0,i.$G)(["settings"]),K=s.chars.keys.length,P=s.arts.values.length,j=s.weapons.values.length,S=Boolean(K||P||j),$=(0,v.useCallback)((()=>navigator.clipboard.writeText(JSON.stringify(s.exportGOOD())).then((()=>alert("Copied database to clipboard."))).catch(console.error)),[s]),M=(0,v.useCallback)((()=>{window.confirm(`Are you sure you want to delete "${d}"?`)&&(s.clear(),s.toExtraLocalDB())}),[s,d]),O=(0,v.useCallback)((()=>{const t=(new Date).toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),e=JSON.stringify(s.exportGOOD()),n=`${d.trim().replaceAll(" ","_")}_${t}.json`,a=document.createElement("a");a.download=n,a.href=`data:application/json;charset=utf-8,${encodeURIComponent(e)}`,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}),[s,d]),V=(0,v.useCallback)((()=>{k||(n.toExtraLocalDB(),s.swapStorage(n),o(t,s))}),[t,o,n,k,s]),[E,T]=(0,v.useState)(d);(0,v.useEffect)((()=>T(d)),[d]);const W=(0,v.useCallback)((()=>{s.dbMeta.set({name:E}),s.toExtraLocalDB()}),[E,s]),F=(0,v.useCallback)((t=>"Enter"===t.key&&W()),[W]);return(0,L.BX)(c.Z,{sx:{height:"100%",boxShadow:k?"0px 0px 0px 2px green inset":void 0},children:[(0,L.BX)(a.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,L.tZ)(y.el,{value:E,sx:{borderRadius:1,px:1,flexGrow:1},onChange:t=>T(t.target.value),onBlur:W,onKeyDown:F}),!k&&(0,L.tZ)(x.Z,{startIcon:(0,L.tZ)(Z,{}),onClick:V,color:"warning",children:H(q||(q=rt`DatabaseCard.button.swap`))}),(0,L.tZ)(C.Z,{color:k?"success":"secondary",label:k?H(Q||(Q=rt`DatabaseCard.currentDB`)):`${H(tt||(tt=rt`DatabaseCard.title`))} ${s.dbIndex}`})]}),(0,L.tZ)(l.Z,{}),(0,L.tZ)(a.Z,{children:(0,L.BX)(b.Z,{display:"flex",gap:2,children:[(0,L.BX)(b.Z,{flexGrow:1,children:[(0,L.BX)(r.Z,{noWrap:!0,children:[(0,L.tZ)(i.cC,{t:H,i18nKey:"count.chars"})," ",(0,L.tZ)("strong",{children:K})]}),(0,L.BX)(r.Z,{noWrap:!0,children:[(0,L.tZ)(i.cC,{t:H,i18nKey:"count.arts"})," ",(0,L.tZ)("strong",{children:P})]}),(0,L.BX)(r.Z,{noWrap:!0,children:[(0,L.tZ)(i.cC,{t:H,i18nKey:"count.weapons"})," ",(0,L.tZ)("strong",{children:j})]}),!!f&&(0,L.tZ)(r.Z,{noWrap:!0,children:(0,L.tZ)("strong",{children:new Date(f).toLocaleString()})})]}),(0,L.tZ)(b.Z,{children:(0,L.BX)(m.ZP,{container:!0,spacing:1,columns:{xs:2},children:[(0,L.tZ)(m.ZP,{item:!0,xs:1,children:(0,L.tZ)(x.Z,{fullWidth:!0,disabled:!S,color:"info",onClick:$,startIcon:(0,L.tZ)(g.Z,{}),children:(0,L.tZ)(i.cC,{t:H,i18nKey:"DatabaseCard.button.copy"})})}),(0,L.BX)(m.ZP,{item:!0,xs:1,children:[(0,L.tZ)(B.Z,{open:I,onClose:G,children:(0,L.tZ)(A,{index:t,onReplace:G})}),(0,L.tZ)(x.Z,{fullWidth:!0,component:"span",color:"info",startIcon:(0,L.tZ)(h,{}),onClick:z,children:H(et||(et=rt`DatabaseCard.button.upload`))})]}),(0,L.tZ)(m.ZP,{item:!0,xs:1,children:(0,L.tZ)(x.Z,{fullWidth:!0,disabled:!S,onClick:O,startIcon:(0,L.tZ)(u.Z,{}),children:H(nt||(nt=rt`DatabaseCard.button.download`))})}),(0,L.tZ)(m.ZP,{item:!0,xs:1,children:(0,L.tZ)(x.Z,{fullWidth:!0,disabled:!S,color:"error",onClick:M,startIcon:(0,L.tZ)(p,{}),children:H(at||(at=rt`DatabaseCard.button.delete`))})})]})})]})})]})}var it=n(94380),ct=n(45475),st=n(83673),dt=n(58918);function Zt(){const{t}=(0,i.$G)();return(0,L.BX)(f.Z,{children:[(0,L.BX)(a.Z,{sx:{py:1},children:[t("settings:languageCard.selectLanguage")," ",(0,L.tZ)(st.Z,{color:"warning",children:t("ui:underConstruction")})]}),(0,L.tZ)(l.Z,{}),(0,L.tZ)(a.Z,{children:(0,L.tZ)(ut,{})})]})}const ht={chs:"\u7b80\u4f53\u4e2d\u6587",cht:"\u7e41\u9ad4\u4e2d\u6587",de:"Deutsch",en:"English",es:"Espa\xf1ol",fr:"Fran\xe7ais",id:"Bahasa Indonesia",it:"Italiano",ja:"\u65e5\u672c\u8a9e",ko:"\ud55c\uad6d\uc5b4",pt:"Portugu\xeas",ru:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a",th:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22",tr:"T\xfcrk\xe7e",vi:"Ti\u1ebfng Vi\u1ec7t"};function ut(){const{t,i18n:e}=(0,i.$G)(["ui","settings"]),n=t=>()=>e.changeLanguage(t),a=e.languages[0];return(0,L.tZ)(ct.Z,{fullWidth:!0,title:t("settings:languageCard.languageFormat",{language:t(`languages:${a}`)}),children:dt.C.map((t=>(0,L.BX)(it.Z,{selected:a===t,disabled:a===t,onClick:n(t),children:[(0,L.tZ)(i.cC,{i18nKey:`languages:${t}`}),t!==a?` (${ht[t]})`:""]},t)))})}function pt(){const{t}=(0,i.$G)(["settings"]);return o.ZP.send({hitType:"pageview",page:"/setting"}),(0,L.BX)(c.Z,{sx:{my:1},children:[(0,L.tZ)(a.Z,{sx:{py:1},children:(0,L.tZ)(r.Z,{variant:"subtitle1",children:(0,L.tZ)(i.cC,{t,i18nKey:"title"})})}),(0,L.tZ)(l.Z,{}),(0,L.BX)(a.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,L.tZ)(Zt,{}),(0,L.tZ)(lt,{})]})]})}}}]);